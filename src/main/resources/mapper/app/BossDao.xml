<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.greencode.modules.app.dao.BossDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="org.greencode.modules.app.entity.BossEntity" id="bossMap">
        <result property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="shopId" column="shop_id"/>
        <result property="dutyDate" column="duty_date"/>
        <result property="dutyType" column="duty_type"/>
        <result property="dutyStatus" column="duty_status"/>
        <result property="dutySubmitTime" column="duty_submit_time"/>
        <result property="operator" column="operator"/>
        <result property="operationTime" column="operation_time"/>
        <result property="operatorIp" column="operator_ip"/>
        <result property="memo" column="memo"/>
    </resultMap>

    <sql id="Base_Column_List">
        id,shop_id,shop_id,duty_date,duty_type,duty_status,duty_submit_time
    </sql>

    <select id="selectByDutyDate" resultType="org.greencode.modules.app.entity.BossEntity">
        select id,shop_id,shop_id,duty_date,duty_type from ba_boss
        where date_format(duty_date,'%Y-%m-%d')=date_format(#{dutyDate},'%Y-%m-%d')
        and duty_type=#{dutyType}
        and duty_status=1
    </select>

    <select id="findNextThreeDay" resultMap="bossMap">
        select <include refid="Base_Column_List" />
        from ba_boss
        WHERE duty_date between now()+1 and ADDDATE(now()+1,INTERVAL 3 DAY)
        and duty_status=1;
    </select>

    <select id="selectByUserId" resultMap="bossMap">
        select <include refid="Base_Column_List" />
        from ba_boss
        WHERE user_id=#{userId}
    </select>

    <select id="selectNotStart" resultMap="bossMap">
        select <include refid="Base_Column_List" />
        from ba_boss
        WHERE user_id=#{userId} and duty_status=1
        and TIMESTAMPDIFF(MINUTE,NOW() ,duty_date)>0;
    </select>
</mapper>